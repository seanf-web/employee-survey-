<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TASK Monthly Employment Check-In</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, sans-serif;
      background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
      margin: 0;
      padding: 20px;
      min-height: 100vh;
    }
    .container {
      max-width: 900px;
      margin: 20px auto;
      background: #fff;
      padding: 30px;
      border-radius: 16px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.12);
    }
    .header-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
    }
    .lang-select {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .progress {
      display: flex;
      justify-content: space-between;
      flex: 1;
      margin-left: 30px;
      counter-reset: step;
    }
    .step {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: #ccc;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 18px;
      margin: 0 10px;
    }
    .step.active {
      background: #145078;
    }
    h1, h2 {
      color: #145078;
      text-align: center;
    }
    h1 { font-size: 2.5em; }
    h2 { font-size: 2em; margin-bottom: 10px; }
    .task-header {
      text-align: center;
      margin-bottom: 30px;
    }
    .task-logo {
      font-size: 3em;
      font-weight: bold;
      color: #145078;
    }
    .powered-by {
      background: #145078;
      color: white;
      padding: 5px 15px;
      border-radius: 20px;
      font-size: 10px;
      font-weight: bold;
      display: inline-block;
      margin-bottom: 10px;
    }
    .participants-only {
      background: #dc2626;
      color: white;
      padding: 10px 20px;
      border-radius: 25px;
      font-weight: bold;
      display: inline-block;
      margin-bottom: 20px;
    }
    .success-banner {
      background: #fff7ed;
      border: 2px solid #fdba74;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 30px;
      text-align: center;
    }
    p.blurb {
      text-align: center;
      font-size: 15px;
      margin-bottom: 20px;
      color: #444;
    }
    label {
      font-weight: bold;
      display: block;
      margin: 12px 0 6px;
      color: #333;
    }
    input, select, textarea {
      width: 100%;
      padding: 12px;
      border: 2px solid #ccc;
      border-radius: 10px;
      font-size: 15px;
      margin-bottom: 16px;
      box-sizing: border-box;
    }
    input:focus, select:focus, textarea:focus {
      border-color: #ff911f;
      box-shadow: 0 0 6px rgba(255,145,31,0.4);
      outline: none;
    }
    .btn {
      padding: 14px 24px;
      border: none;
      border-radius: 12px;
      font-weight: bold;
      cursor: pointer;
      margin: 10px 5px 0 0;
      background: linear-gradient(135deg, #145078, #33a7b5);
      color: white;
    }
    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }
    .grid-2 {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
    }
    .highlight-box {
      border: 2px solid #facc15;
      border-radius: 12px;
      padding: 20px;
      margin: 20px 0;
    }
    .highlight-box.yellow { background: #fefce8; border-color: #facc15; }
    .highlight-box.green { background: #f0fdf4; border-color: #86efac; }
    .highlight-box.blue { background: #eff6ff; border-color: #93c5fd; }
    .highlight-box.orange { background: #fff7ed; border-color: #fdba74; }
    .radio-group {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
    }
    .radio-option {
      display: flex;
      align-items: center;
      padding: 15px;
      border: 2px solid #86efac;
      border-radius: 12px;
      cursor: pointer;
    }
    .radio-option input {
      margin-right: 10px;
      transform: scale(1.2);
      width: auto;
    }
    .upload-section {
      background: #fefce8;
      border: 3px solid #facc15;
      border-radius: 16px;
      padding: 30px;
      margin: 30px 0;
    }
    .upload-options {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin: 20px 0;
    }
    .upload-box {
      background: white;
      border: 2px solid #93c5fd;
      border-radius: 12px;
      padding: 20px;
      text-align: center;
    }
    .task-office {
      background: #dbeafe;
      border: 3px solid #3b82f6;
      border-radius: 16px;
      padding: 30px;
      margin: 30px 0;
    }
    .survey-completed {
      background: #fee2e2;
      border: 2px solid #f87171;
      border-radius: 12px;
      padding: 20px;
      margin: 20px 0;
      text-align: center;
    }
    .office-info {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin: 20px 0;
    }
    .contact-item {
      display: flex;
      align-items: center;
      margin: 10px 0;
      gap: 10px;
    }
    .reward-program {
      background: #dcfce7;
      border: 2px solid #86efac;
      border-radius: 12px;
      padding: 20px;
      margin: 20px 0;
      text-align: center;
    }
    .preview {
      margin: 15px 0;
    }
    .preview img {
      max-width: 150px;
      margin: 5px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.15);
    }
    @media (max-width: 768px) {
      .grid-2, .radio-group, .upload-options, .office-info {
        grid-template-columns: 1fr;
      }
      .header-bar {
        flex-direction: column;
        gap: 15px;
      }
      .progress {
        margin-left: 0;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div id="survey"></div>
  </div>

<script>
let page = 1;
let formData = {};
let lang = "en";

const translations = {
  en: {
    // Header
    poweredBy: "POWERED BY ENGAGE BY CELL",
    participantsOnly: "FOR TASK EMPLOYMENT PROGRAM PARTICIPANTS ONLY",
    taskLogo: "TASK",
    monthlyCheckin: "Monthly Employment Check-In",
    reportJob: "Report on the job TASK helped you secure",
    
    // Navigation
    continue: "Continue",
    back: "Back",
    submit: "Submit Monthly Report",
    
    // Success banner
    celebrating: "Celebrating Your Employment Success!",
    successNetwork: "You are part of TASK's employment success network! This monthly check-in helps us track your job stability and provide ongoing support.",
    
    // Step 1
    step1title: "Step 1: Contact Information",
    step1blurb: "We collect your contact info so TASK can stay in touch and provide support.",
    firstName: "First Name *",
    lastName: "Last Name *",
    phone: "Phone Number *",
    email: "Email *",
    preferredContact: "Preferred Contact Method",
    monthsEmployed: "How many months have you been employed through TASK's job placement program? *",
    contactOptions: ["Phone", "Email", "Text Message"],
    
    // Step 2
    step2title: "Step 2: Current Employment Status",
    step2blurb: "Tell us about the job TASK helped you secure",
    employer: "Current Employer (TASK Job Placement) *",
    jobTitle: "Job Title",
    startDate: "Start Date *",
    hoursPerWeek: "Hours per Week",
    payRate: "Pay Rate/Salary *",
    stillWorking: "Are you still employed at this TASK-assisted job? *",
    yesEmployed: "Yes, still employed",
    noEmployed: "No longer employed",
    yesHelper: "Great job maintaining employment",
    noHelper: "We are here to help you find another job",
    
    // Step 3
    step3title: "Step 3: Monthly Documentation & Support",
    step3blurb: "Share your feedback and upload employment verification",
    q1: "What has helped you stay successful in your TASK-assisted job?",
    q1placeholder: "Share your success factors: supportive management, flexible schedule, good pay, transportation solutions...",
    q2: "What ongoing challenges can TASK help you address?",
    q2placeholder: "Current challenges: transportation issues, childcare needs, housing concerns, financial stress...",
    q3: "How has TASK support made a difference in your employment journey?",
    q3placeholder: "Share your TASK impact story: job search assistance, interview preparation, work clothes...",
    
    // File upload
    employmentVerification: "Monthly Employment Verification",
    uploadRequired: "Required: Upload or photograph your last 2 pay stubs",
    takePhotoNow: "Take Photo Now",
    useCamera: "Use your phone camera",
    uploadFiles: "Upload Files",
    chooseFiles: "Choose PDF or image files",
    openCamera: "Open Camera",
    chooseFilesBtn: "Choose Files",
    
    // Authorization
    authorization: "Continued Support Authorization *",
    authText: "I authorize TASK to:",
    authList: [
      "Contact me monthly for employment check-ins and support",
      "Provide information about additional resources and services", 
      "Connect me with emergency assistance if needed",
      "Follow up if employment status changes"
    ],
    
    // Success page
    submitted: "Monthly Report Submitted Successfully!",
    thanks: "Thank you for your continued commitment to employment success through TASK!",
    surveyCompleted: "SURVEY COMPLETED!",
    completedMessage: "You have successfully completed your monthly employment survey. Visit the TASK Employment Office to receive your gift card reward.",
    
    // Office info
    taskOffice: "TASK EMPLOYMENT OFFICE",
    trentonSoup: "Trenton Area Soup Kitchen",
    address: "72Â½ Escher St, Trenton, NJ 08609",
    employmentOffice: "Employment Office",
    phone: "(609) 697-6215",
    mealTimeHours: "Meal Time Hours",
    mealHours1: "Mon-Fri: 10:30 AM - 1:00 PM",
    mealHours2: "Mon-Thu: 3:30 PM - 5:00 PM", 
    online: "Online",
    website: "trentonsoupkitchen.org",
    rewardProgram: "REWARD PROGRAM",
    rewardText: "Complete monthly surveys and maintain employment to earn gift card rewards! Visit our Employment Office to claim your incentive.",
    
    // Validation
    completeRequired: "Please complete all required fields before continuing.",
    uploadPayStub: "Please upload at least one pay stub before submitting.",
    alreadySubmitted: "You have already submitted a report recently. Please contact the TASK office if you need to submit another report.",
    
    // Testing
    startNewReport: "Start New Report (Testing)"
  },
  
  es: {
    // Header
    poweredBy: "DESARROLLADO POR ENGAGE BY CELL",
    participantsOnly: "SOLO PARA PARTICIPANTES DEL PROGRAMA DE EMPLEO TASK",
    taskLogo: "TASK",
    monthlyCheckin: "VerificaciÃ³n Mensual de Empleo",
    reportJob: "Informe sobre el trabajo que TASK te ayudÃ³ a conseguir",
    
    // Navigation
    continue: "Continuar",
    back: "AtrÃ¡s",
    submit: "Enviar Reporte Mensual",
    
    // Success banner
    celebrating: "Â¡Celebrando Tu Ãxito Laboral!",
    successNetwork: "Â¡Eres parte de la red de Ã©xito laboral de TASK! Esta verificaciÃ³n mensual nos ayuda a seguir tu estabilidad laboral y brindarte apoyo continuo.",
    
    // Step 1
    step1title: "Paso 1: InformaciÃ³n de Contacto",
    step1blurb: "Recopilamos tu informaciÃ³n de contacto para que TASK pueda mantenerse en contacto y brindarte apoyo.",
    firstName: "Nombre *",
    lastName: "Apellido *",
    phone: "NÃºmero de TelÃ©fono *",
    email: "Correo electrÃ³nico *",
    preferredContact: "MÃ©todo de Contacto Preferido",
    monthsEmployed: "Â¿CuÃ¡ntos meses has estado empleado a travÃ©s del programa de colocaciÃ³n laboral de TASK? *",
    contactOptions: ["TelÃ©fono", "Correo electrÃ³nico", "Mensaje de texto"],
    
    // Step 2
    step2title: "Paso 2: Estado de Empleo Actual",
    step2blurb: "CuÃ©ntanos sobre el trabajo que TASK te ayudÃ³ a conseguir",
    employer: "Empleador Actual (ColocaciÃ³n Laboral TASK) *",
    jobTitle: "TÃ­tulo del Trabajo",
    startDate: "Fecha de Inicio *",
    hoursPerWeek: "Horas por Semana",
    payRate: "Tarifa de Pago/Salario *",
    stillWorking: "Â¿Sigues empleado en este trabajo asistido por TASK? *",
    yesEmployed: "SÃ­, aÃºn empleado",
    noEmployed: "Ya no empleado",
    yesHelper: "Excelente trabajo manteniendo el empleo",
    noHelper: "Estamos aquÃ­ para ayudarte a encontrar otro trabajo",
    
    // Step 3
    step3title: "Paso 3: DocumentaciÃ³n Mensual y Apoyo",
    step3blurb: "Comparte tus comentarios y sube la verificaciÃ³n de empleo",
    q1: "Â¿QuÃ© te ha ayudado a mantenerte exitoso en tu trabajo asistido por TASK?",
    q1placeholder: "Comparte tus factores de Ã©xito: gerencia solidaria, horario flexible, buen pago, soluciones de transporte...",
    q2: "Â¿QuÃ© desafÃ­os continuos puede ayudarte TASK a abordar?",
    q2placeholder: "DesafÃ­os actuales: problemas de transporte, necesidades de cuidado infantil, preocupaciones de vivienda, estrÃ©s financiero...",
    q3: "Â¿CÃ³mo el apoyo de TASK ha marcado la diferencia en tu trayectoria laboral?",
    q3placeholder: "Comparte tu historia de impacto TASK: asistencia en bÃºsqueda de empleo, preparaciÃ³n para entrevistas, ropa de trabajo...",
    
    // File upload
    employmentVerification: "VerificaciÃ³n Mensual de Empleo",
    uploadRequired: "Requerido: Sube o fotografÃ­a tus Ãºltimos 2 talones de pago",
    takePhotoNow: "Tomar Foto Ahora",
    useCamera: "Usa la cÃ¡mara de tu telÃ©fono",
    uploadFiles: "Subir Archivos",
    chooseFiles: "Elige archivos PDF o imÃ¡genes",
    openCamera: "Abrir CÃ¡mara",
    chooseFilesBtn: "Elegir Archivos",
    
    // Authorization
    authorization: "AutorizaciÃ³n de Apoyo Continuo *",
    authText: "Autorizo a TASK a:",
    authList: [
      "Contactarme mensualmente para verificaciones de empleo y apoyo",
      "Proporcionar informaciÃ³n sobre recursos y servicios adicionales",
      "Conectarme con asistencia de emergencia si es necesario", 
      "Hacer seguimiento si el estado de empleo cambia"
    ],
    
    // Success page
    submitted: "Â¡Reporte Mensual Enviado Exitosamente!",
    thanks: "Â¡Gracias por tu compromiso continuo con el Ã©xito laboral a travÃ©s de TASK!",
    surveyCompleted: "Â¡ENCUESTA COMPLETADA!",
    completedMessage: "Has completado exitosamente tu encuesta mensual de empleo. Visita la Oficina de Empleo TASK para recibir tu recompensa de tarjeta de regalo.",
    
    // Office info
    taskOffice: "OFICINA DE EMPLEO TASK",
    trentonSoup: "Cocina de Sopa del Ãrea de Trenton",
    address: "72Â½ Escher St, Trenton, NJ 08609",
    employmentOffice: "Oficina de Empleo",
    phone: "(609) 697-6215",
    mealTimeHours: "Horarios de Comida",
    mealHours1: "Lun-Vie: 10:30 AM - 1:00 PM",
    mealHours2: "Lun-Jue: 3:30 PM - 5:00 PM",
    online: "En LÃ­nea", 
    website: "trentonsoupkitchen.org",
    rewardProgram: "PROGRAMA DE RECOMPENSAS",
    rewardText: "Â¡Completa las encuestas mensuales y mantÃ©n el empleo para ganar recompensas de tarjetas de regalo! Visita nuestra Oficina de Empleo para reclamar tu incentivo.",
    
    // Validation
    completeRequired: "Por favor completa todos los campos requeridos antes de continuar.",
    uploadPayStub: "Por favor sube al menos un talÃ³n de pago antes de enviar.",
    alreadySubmitted: "Ya enviaste un reporte recientemente. Contacta la oficina TASK si necesitas enviar otro reporte.",
    
    // Testing
    startNewReport: "Iniciar Nuevo Reporte (Prueba)"
  },
  
  ht: {
    // Header
    poweredBy: "DEPO PAR ENGAGE BY CELL",
    participantsOnly: "POU PATISIPAN PWOGRAM TRAVAY TASK YO SÃLMAN",
    taskLogo: "TASK",
    monthlyCheckin: "Verifikasyon Travay Chak Mwa",
    reportJob: "RapÃ² sou travay TASK te ede ou jwenn nan",
    
    // Navigation
    continue: "Kontinye",
    back: "Retounen", 
    submit: "SoumÃ¨t RapÃ² Chak Mwa",
    
    // Success banner
    celebrating: "Selebre SiksÃ¨ Travay Ou!",
    successNetwork: "Ou se yon pati nan rezo siksÃ¨ travay TASK la! Verifikasyon chak mwa sa a ede nou swiv estabilite travay ou ak bay sipÃ² kontinyÃ¨l.",
    
    // Step 1
    step1title: "Etap 1: EnfÃ²masyon Kontak",
    step1blurb: "Nou kolekte enfÃ²masyon kontak ou pou TASK ka rete nan kontak ak ba ou sipÃ².",
    firstName: "Non *",
    lastName: "Siyati *",
    phone: "Nimewo TelefÃ²n *",
    email: "ImÃ¨l *",
    preferredContact: "MetÃ²d Kontak Prefere",
    monthsEmployed: "Konbyen mwa ou te gen travay nan pwogram plasÃ¨ travay TASK la? *",
    contactOptions: ["TelefÃ²n", "ImÃ¨l", "Mesaj tÃ¨ks"],
    
    // Step 2
    step2title: "Etap 2: Estati Travay AktyÃ¨l",
    step2blurb: "Di nou sou travay TASK te ede ou jwenn nan",
    employer: "AnplwayÃ¨ AktyÃ¨l (PlasÃ¨ Travay TASK) *",
    jobTitle: "Tit Travay",
    startDate: "Dat KÃ²manse *",
    hoursPerWeek: "Ãdtan chak SemÃ¨n",
    payRate: "Tarif SalÃ¨/Peman *",
    stillWorking: "Ãske w ap toujou travay nan travay TASK asiste sa a? *",
    yesEmployed: "Wi, toujou gen travay",
    noEmployed: "Pa gen travay ankÃ²",
    yesHelper: "Bon travay kenbe travay la",
    noHelper: "Nou la pou ede ou jwenn yon lÃ²t travay",
    
    // Step 3
    step3title: "Etap 3: Dokiman Chak Mwa ak SipÃ²",
    step3blurb: "Pataje kÃ²mantÃ¨ ou yo ak telechaje verifikasyon travay",
    q1: "Kisa ki te ede ou rete siksÃ¨sÃ¨ nan travay TASK asiste ou a?",
    q1placeholder: "Pataje faktÃ¨ siksÃ¨ ou yo: jesyon sipÃ², orÃ¨ fleksib, bon salÃ¨, solisyon transpÃ²...",
    q2: "Ki defi k ap kontinye TASK ka ede ou adrese?",
    q2placeholder: "Defi aktyÃ¨l yo: pwoblÃ¨m transpÃ², bezwen swen timoun, enkyÃ¨tid lojman, estres finansye...",
    q3: "Kijan sipÃ² TASK fÃ¨ yon diferans nan vwayaj travay ou?",
    q3placeholder: "Pataje istwa enpak TASK ou: asistans rechÃ¨ch travay, preparasyon entÃ¨vyou, rad travay...",
    
    // File upload
    employmentVerification: "Verifikasyon Travay Chak Mwa",
    uploadRequired: "Obligatwa: Telechaje oswa pran foto 2 dÃ¨nye fich peman ou yo",
    takePhotoNow: "Pran Foto Kounye a",
    useCamera: "SÃ¨vi ak kamera telefÃ²n ou",
    uploadFiles: "Telechaje Fichye",
    chooseFiles: "Chwazi fichye PDF oswa imaj",
    openCamera: "OuvÃ¨ Kamera",
    chooseFilesBtn: "Chwazi Fichye",
    
    // Authorization
    authorization: "Otorizasyon SipÃ² Kontinye *",
    authText: "Mwen otorize TASK pou:",
    authList: [
      "Kontakte m chak mwa pou verifikasyon travay ak sipÃ²",
      "Bay enfÃ²masyon sou resous ak sÃ¨vis adisyonÃ¨l",
      "Konekte m ak asistans ijans si necessÃ¨",
      "FÃ¨ swivi si estati travay chanje"
    ],
    
    // Success page
    submitted: "RapÃ² Chak Mwa SoumÃ¨t ak SiksÃ¨!",
    thanks: "MÃ¨si pou angajman kontinyÃ¨ ou nan siksÃ¨ travay nan TASK!",
    surveyCompleted: "SONDAJ KONPLETE!",
    completedMessage: "Ou te konplete ak siksÃ¨ sondaj travay chak mwa ou. Vizite Biwo Travay TASK pou resevwa rekonpans kat kado ou.",
    
    // Office info
    taskOffice: "BIWO TRAVAY TASK",
    trentonSoup: "Kizin Soup ZÃ²n Trenton",
    address: "72Â½ Escher St, Trenton, NJ 08609",
    employmentOffice: "Biwo Travay",
    phone: "(609) 697-6215",
    mealTimeHours: "Ãdtan Manje",
    mealHours1: "Lendi-Vandredi: 10:30 AM - 1:00 PM",
    mealHours2: "Lendi-Jedi: 3:30 PM - 5:00 PM",
    online: "Sou EntÃ¨nÃ¨t",
    website: "trentonsoupkitchen.org", 
    rewardProgram: "PWOGRAM REKONPANS",
    rewardText: "Konplete sondaj chak mwa yo ak kenbe travay pou ou ka gen rekonpans kat kado! Vizite Biwo Travay nou an pou reklame ensÃ¨ntif ou.",
    
    // Validation
    completeRequired: "Tanpri konplete tout jaden obligatwa yo anvan kontinye.",
    uploadPayStub: "Tanpri telechaje omwen yon fich peman anvan soumÃ¨t.",
    alreadySubmitted: "Ou te soumÃ¨t yon rapÃ² deja. Kontakte biwo TASK la si ou bezwen soumÃ¨t yon lÃ²t rapÃ².",
    
    // Testing
    startNewReport: "KÃ²manse Nouvo RapÃ² (TÃ¨s)"
  }
};

// Generate months dropdown options dynamically
function generateMonthsOptions() {
  const options = [];
  const t = translations[lang];
  
  if (lang === 'en') {
    options.push("Select months employed...");
    for (let i = 1; i <= 120; i++) { // Up to 10 years (120 months)
      if (i === 12) {
        options.push(`${i} months (1 year)`);
      } else if (i > 12) {
        const years = Math.floor(i / 12);
        const remainingMonths = i % 12;
        let label = `${i} months (${years} year`;
        if (years > 1) label += "s";
        if (remainingMonths > 0) {
          label += `, ${remainingMonths} month`;
          if (remainingMonths > 1) label += "s";
        }
        label += ")";
        options.push(label);
      } else {
        options.push(`${i} month${i > 1 ? 's' : ''}`);
      }
    }
  } else if (lang === 'es') {
    options.push("Seleccionar meses empleado...");
    for (let i = 1; i <= 120; i++) { // Up to 10 years (120 months)
      if (i === 12) {
        options.push(`${i} meses (1 aÃ±o)`);
      } else if (i > 12) {
        const years = Math.floor(i / 12);
        const remainingMonths = i % 12;
        let label = `${i} meses (${years} aÃ±o`;
        if (years > 1) label += "s";
        if (remainingMonths > 0) {
          label += `, ${remainingMonths} mes`;
          if (remainingMonths > 1) label += "es";
        }
        label += ")";
        options.push(label);
      } else {
        options.push(`${i} mes${i > 1 ? 'es' : ''}`);
      }
    }
  } else if (lang === 'ht') {
    options.push("Chwazi mwa travay yo...");
    for (let i = 1; i <= 120; i++) { // Up to 10 years (120 months)
      if (i === 12) {
        options.push(`${i} mwa (1 ane)`);
      } else if (i > 12) {
        const years = Math.floor(i / 12);
        const remainingMonths = i % 12;
        let label = `${i} mwa (${years} ane`;
        if (remainingMonths > 0) {
          label += `, ${remainingMonths} mwa`;
        }
        label += ")";
        options.push(label);
      } else {
        options.push(`${i} mwa`);
      }
    }
  }
  
  return options;
}

function setLanguage(l) {
  lang = l;
  localStorage.setItem('taskLanguage', l);
  renderPage();
}

function renderPage() {
  const t = translations[lang];
  
  let html = "";
  
  // Step 1: Contact Information
  if (page === 1) {
    const monthsOptions = generateMonthsOptions();
    
    html = `
      <div class="header-bar">
        <div class="lang-select">
          ð <select id="langToggle" onchange="setLanguage(this.value)">
            <option value="en" ${lang === 'en' ? 'selected' : ''}>English</option>
            <option value="es" ${lang === 'es' ? 'selected' : ''}>EspaÃ±ol</option>
            <option value="ht" ${lang === 'ht' ? 'selected' : ''}>KreyÃ²l</option>
          </select>
        </div>
        <div class="progress">
          <div class="step active">1</div>
          <div class="step">2</div>
          <div class="step">3</div>
          <div class="step">4</div>
        </div>
      </div>

      <div class="task-header">
        <div class="powered-by">${t.poweredBy}</div>
        <div class="participants-only">${t.participantsOnly}</div>
        <div class="task-logo">${t.taskLogo}</div>
        <h2>${t.monthlyCheckin}</h2>
        <p class="blurb">${t.reportJob}</p>
      </div>

      <div class="success-banner">
        <div style="display: flex; align-items: center; justify-content: center; gap: 10px; margin-bottom: 10px;">
          <span style="font-size: 24px;">ð</span>
          <span style="font-size: 20px; font-weight: bold; color: #145078;">${t.celebrating}</span>
          <span style="font-size: 24px;">â­</span>
        </div>
        <p style="color: #145078;">${t.successNetwork}</p>
      </div>

      <h2>${t.step1title}</h2>
      <p class="blurb">${t.step1blurb}</p>
      
      <div class="grid-2">
        <div>
          <label>${t.firstName}</label>
          <input id="firstName" required value="${formData.firstName || ''}">
        </div>
        <div>
          <label>${t.lastName}</label>
          <input id="lastName" required value="${formData.lastName || ''}">
        </div>
        <div>
          <label>${t.phone}</label>
          <input id="phone" type="tel" oninput="formatPhone(this)" required value="${formData.phone || ''}">
        </div>
        <div>
          <label>${t.email}</label>
          <input id="email" type="email" required value="${formData.email || ''}">
        </div>
      </div>
      
      <label>${t.preferredContact}</label>
      <select id="preferredContact">
        ${t.contactOptions.map((option, i) => 
          `<option value="${option}" ${formData.preferredContact === option ? 'selected' : ''}>${option}</option>`
        ).join('')}
      </select>

      <div class="highlight-box yellow">
        <label style="font-size: 18px; font-weight: bold;">${t.monthsEmployed}</label>
        <select id="monthsEmployed" style="border-color: #facc15; font-size: 16px; font-weight: 600;" required>
          ${monthsOptions.map((option, i) => 
            `<option value="${i === 0 ? '' : option}" ${formData.monthsEmployed === option ? 'selected' : ''}>${option}</option>`
          ).join('')}
        </select>
      </div>

      <div style="text-align: right;">
        <button class="btn" onclick="nextPage()">${t.continue} â</button>
      </div>`;
  }
  
  // Step 2: Employment Information  
  if (page === 2) {
    html = `
      <div class="header-bar">
        <div class="lang-select">
          ð <select id="langToggle" onchange="setLanguage(this.value)">
            <option value="en" ${lang === 'en' ? 'selected' : ''}>English</option>
            <option value="es" ${lang === 'es' ? 'selected' : ''}>EspaÃ±ol</option>
            <option value="ht" ${lang === 'ht' ? 'selected' : ''}>KreyÃ²l</option>
          </select>
        </div>
        <div class="progress">
          <div class="step active">1</div>
          <div class="step active">2</div>
          <div class="step">3</div>
          <div class="step">4</div>
        </div>
      </div>

      <h2>${t.step2title}</h2>
      <p class="blurb">${t.step2blurb}</p>

      <div class="highlight-box green">
        <label style="font-size: 18px; font-weight: bold; margin-bottom: 15px; display: block;">${t.stillWorking}</label>
        <div class="radio-group">
          <label class="radio-option">
            <input type="radio" name="stillWorking" value="yes" ${formData.stillWorking === 'yes' ? 'checked' : ''}>
            <div>
              <div style="font-weight: bold; color: #145078;">${t.yesEmployed}</div>
              <div style="font-size: 12px; color: #16a34a;">${t.yesHelper}</div>
            </div>
          </label>
          <label class="radio-option" style="border-color: #fca5a5;">
            <input type="radio" name="stillWorking" value="no" ${formData.stillWorking === 'no' ? 'checked' : ''}>
            <div>
              <div style="font-weight: bold; color: #145078;">${t.noEmployed}</div>
              <div style="font-size: 12px; color: #dc2626;">${t.noHelper}</div>
            </div>
          </label>
        </div>
      </div>

      <div class="highlight-box yellow">
        <label style="font-size: 18px; font-weight: bold;">${t.employer}</label>
        <input id="employer" placeholder="Company name where TASK helped you get hired" style="border-color: #facc15; font-size: 16px;" required value="${formData.employer || ''}">
      </div>

      <div class="grid-2">
        <div>
          <label>${t.jobTitle}</label>
          <input id="jobTitle" placeholder="e.g., Cook, Warehouse Associate" value="${formData.jobTitle || ''}">
        </div>
        <div>
          <label>${t.startDate}</label>
          <input id="startDate" type="date" required value="${formData.startDate || ''}">
        </div>
        <div>
          <label>${t.hoursPerWeek}</label>
          <input id="hoursPerWeek" type="number" placeholder="e.g., 40" value="${formData.hoursPerWeek || ''}">
        </div>
        <div>
          <label>${t.payRate}</label>
          <input id="payRate" placeholder="e.g., $15/hour or $2,400/month" required value="${formData.payRate || ''}">
        </div>
      </div>

      <div style="display: flex; justify-content: space-between;">
        <button class="btn" onclick="prevPage()">â ${t.back}</button>
        <button class="btn" onclick="nextPage()">${t.continue} â</button>
      </div>`;
  }
  
  // Step 3: Survey and Upload
  if (page === 3) {
    html = `
      <div class="header-bar">
        <div class="lang-select">
          ð <select id="langToggle" onchange="setLanguage(this.value)">
            <option value="en" ${lang === 'en' ? 'selected' : ''}>English</option>
            <option value="es" ${lang === 'es' ? 'selected' : ''}>EspaÃ±ol</option>
            <option value="ht" ${lang === 'ht' ? 'selected' : ''}>KreyÃ²l</option>
          </select>
        </div>
        <div class="progress">
          <div class="step active">1</div>
          <div class="step active">2</div>
          <div class="step active">3</div>
          <div class="step">4</div>
        </div>
      </div>

      <h2>${t.step3title}</h2>
      <p class="blurb">${t.step3blurb}</p>

      <div class="highlight-box green">
        <label>${t.q1}</label>
        <textarea id="q1" rows="4" placeholder="${t.q1placeholder}">${formData.q1 || ''}</textarea>
      </div>

      <div class="highlight-box orange">
        <label>${t.q2}</label>
        <textarea id="q2" rows="4" placeholder="${t.q2placeholder}">${formData.q2 || ''}</textarea>
      </div>

      <div class="highlight-box blue">
        <label>${t.q3}</label>
        <textarea id="q3" rows="4" placeholder="${t.q3placeholder}">${formData.q3 || ''}</textarea>
      </div>

      <div class="upload-section">
        <div style="text-align: center; margin-bottom: 20px;">
          <h3 style="font-size: 24px; color: #145078; margin-bottom: 10px;">${t.employmentVerification}</h3>
          <p style="font-size: 18px; color: #145078;">${t.uploadRequired}</p>
        </div>
        
        <div class="upload-options">
          <div class="upload-box">
            <div style="font-size: 48px; margin-bottom: 15px;">ð·</div>
            <h4 style="color: #145078; margin-bottom: 10px;">${t.takePhotoNow}</h4>
            <p style="font-size: 14px; color: #6b7280; margin-bottom: 15px;">${t.useCamera}</p>
            <input type="file" id="payStubCamera" accept="image/*" capture="environment" style="display: none;" onchange="previewFile(this, 'cameraPreview')">
            <button class="btn" onclick="document.getElementById('payStubCamera').click()">ð· ${t.openCamera}</button>
          </div>
          
          <div class="upload-box" style="border-color: #86efac;">
            <div style="font-size: 48px; margin-bottom: 15px;">ð</div>
            <h4 style="color: #145078; margin-bottom: 10px;">${t.uploadFiles}</h4>
            <p style="font-size: 14px; color: #6b7280; margin-bottom: 15px;">${t.chooseFiles}</p>
            <input type="file" id="payStubFile" accept=".pdf,image/*" multiple style="display: none;" onchange="previewFile(this, 'filePreview')">
            <button class="btn" onclick="document.getElementById('payStubFile').click()">ð ${t.chooseFilesBtn}</button>
          </div>
        </div>
        
        <div id="cameraPreview" class="preview"></div>
        <div id="filePreview" class="preview"></div>
      </div>

      <div class="highlight-box blue">
        <label style="display: flex; align-items: start; cursor: pointer;">
          <input type="checkbox" id="authorization" style="margin-top: 8px; margin-right: 15px; transform: scale(1.3); width: auto;">
          <div>
            <span style="font-size: 18px; font-weight: bold; color: #145078;">${t.authorization}</span>
            <div style="font-size: 14px; margin-top: 8px; color: #145078;">
              <p style="margin-bottom: 8px;">${t.authText}</p>
              <div style="margin-left: 0;">
                ${t.authList.map(item => `<div style="margin-bottom: 4px;">â¢ ${item}</div>`).join('')}
              </div>
            </div>
          </div>
        </label>
      </div>

      <div style="display: flex; justify-content: space-between;">
        <button class="btn" onclick="prevPage()">â ${t.back}</button>
        <button class="btn" onclick="submitSurvey()">${t.submit}</button>
      </div>`;
  }
  
  // Step 4: Success Page
  if (page === 4) {
    const submissionId = formData.submissionId || 'TASK_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
    const submitTime = formData.timestamp || new Date().toLocaleString();
    
    html = `
      <div style="text-align: center;">
        <div style="font-size: 80px; margin-bottom: 20px;">ð</div>
        <h1 style="color: #16a34a;">${t.submitted}</h1>
        <p style="font-size: 20px; color: #6b7280; margin-bottom: 30px;">${t.thanks}</p>

        <div class="task-office">
          <div style="display: flex; align-items: center; justify-content: center; gap: 15px; margin-bottom: 25px;">
            <div style="background: #3b82f6; color: white; padding: 8px 16px; border-radius: 8px; font-weight: bold;">TASK</div>
            <span style="font-size: 28px; font-weight: bold; color: #145078;">${t.taskOffice}</span>
            <span style="font-size: 32px; color: #dc2626;">â¤ï¸</span>
          </div>

          <div class="survey-completed">
            <div style="display: flex; align-items: center; justify-content: center; gap: 10px; margin-bottom: 15px;">
              <span style="font-size: 24px;">â</span>
              <span style="font-size: 24px; font-weight: bold; color: #7f1d1d;">${t.surveyCompleted}</span>
              <span style="font-size: 24px;">ð</span>
            </div>
            <p style="font-size: 18px; font-weight: 500; color: #7f1d1d;">
              ${t.completedMessage}
            </p>
          </div>
          
          <div class="office-info">
            <div style="color: #145078;">
              <div class="contact-item">
                <span style="font-size: 20px;">ð</span>
                <div>
                  <div style="font-weight: bold; font-size: 18px;">${t.trentonSoup}</div>
                  <div style="font-size: 14px; margin-top: 4px;">${t.address}</div>
                </div>
              </div>
              
              <div class="contact-item" style="margin-top: 15px;">
                <span style="font-size: 20px;">ð</span>
                <div>
                  <div style="font-weight: bold;">${t.employmentOffice}</div>
                  <div style="font-size: 14px;">${t.phone}</div>
                </div>
              </div>
            </div>

            <div style="color: #145078;">
              <div class="contact-item">
                <span style="font-size: 20px;">ð</span>
                <div>
                  <div style="font-weight: bold;">${t.mealTimeHours}</div>
                  <div style="font-size: 14px; margin-top: 4px;">${t.mealHours1}</div>
                  <div style="font-size: 14px;">${t.mealHours2}</div>
                </div>
              </div>
              
              <div class="contact-item" style="margin-top: 15px;">
                <span style="font-size: 20px;">ð</span>
                <div>
                  <div style="font-weight: bold;">${t.online}</div>
                  <div style="font-size: 14px;">${t.website}</div>
                </div>
              </div>
            </div>
          </div>

          <div class="reward-program">
            <div style="display: flex; align-items: center; justify-content: center; gap: 10px; margin-bottom: 15px;">
              <span style="font-size: 24px;">ðµ</span>
              <span style="font-size: 20px; font-weight: bold; color: #166534;">${t.rewardProgram}</span>
              <span style="font-size: 24px;">â­</span>
            </div>
            <p style="color: #166534; font-weight: 500;">
              ${t.rewardText}
            </p>
          </div>
        </div>

        <div style="margin-top: 40px;">
          <button class="btn" onclick="resetForm()" style="background: #6b7280;">${t.startNewReport}</button>
        </div>
      </div>`;
  }
  
  document.getElementById("survey").innerHTML = html;
}

function formatPhone(input) {
  let val = input.value.replace(/\D/g, '');
  if (val.length > 3 && val.length <= 6) {
    input.value = `(${val.slice(0, 3)}) ${val.slice(3)}`;
  } else if (val.length > 6) {
    input.value = `(${val.slice(0, 3)}) ${val.slice(3, 6)}-${val.slice(6, 10)}`;
  } else {
    input.value = val;
  }
}

function previewFile(input, previewId) {
  const preview = document.getElementById(previewId);
  preview.innerHTML = "";
  
  if (input.files.length > 0) {
    const fileCount = document.createElement('p');
    fileCount.textContent = `${input.files.length} file(s) selected`;
    fileCount.style.fontWeight = 'bold';
    fileCount.style.color = '#16a34a';
    fileCount.style.marginBottom = '15px';
    preview.appendChild(fileCount);
  }
  
  Array.from(input.files).forEach(file => {
    if (file.type.startsWith("image/")) {
      const reader = new FileReader();
      reader.onload = e => {
        const img = document.createElement("img");
        img.src = e.target.result;
        preview.appendChild(img);
      };
      reader.readAsDataURL(file);
    } else {
      const fileDiv = document.createElement("div");
      fileDiv.style.background = '#f3f4f6';
      fileDiv.style.border = '1px solid #d1d5db';
      fileDiv.style.borderRadius = '6px';
      fileDiv.style.padding = '10px';
      fileDiv.style.margin = '5px';
      fileDiv.textContent = file.name;
      preview.appendChild(fileDiv);
    }
  });
}

function saveFormData() {
  if (page === 1) {
    formData.firstName = document.getElementById('firstName')?.value || '';
    formData.lastName = document.getElementById('lastName')?.value || '';
    formData.phone = document.getElementById('phone')?.value || '';
    formData.email = document.getElementById('email')?.value || '';
    formData.preferredContact = document.getElementById('preferredContact')?.value || '';
    formData.monthsEmployed = document.getElementById('monthsEmployed')?.value || '';
  }
  
  if (page === 2) {
    const stillWorkingRadio = document.querySelector('input[name="stillWorking"]:checked');
    formData.stillWorking = stillWorkingRadio?.value || '';
    formData.employer = document.getElementById('employer')?.value || '';
    formData.jobTitle = document.getElementById('jobTitle')?.value || '';
    formData.startDate = document.getElementById('startDate')?.value || '';
    formData.hoursPerWeek = document.getElementById('hoursPerWeek')?.value || '';
    formData.payRate = document.getElementById('payRate')?.value || '';
  }
  
  if (page === 3) {
    formData.q1 = document.getElementById('q1')?.value || '';
    formData.q2 = document.getElementById('q2')?.value || '';
    formData.q3 = document.getElementById('q3')?.value || '';
    formData.authorization = document.getElementById('authorization')?.checked || false;
  }
}

function validatePage() {
  const t = translations[lang];
  
  if (page === 1) {
    const required = ['firstName', 'lastName', 'phone', 'email', 'monthsEmployed'];
    for (let field of required) {
      const element = document.getElementById(field);
      if (!element?.value.trim()) {
        alert(t.completeRequired);
        element?.focus();
        return false;
      }
    }
  }
  
  if (page === 2) {
    const stillWorkingRadio = document.querySelector('input[name="stillWorking"]:checked');
    if (!stillWorkingRadio) {
      alert(t.completeRequired);
      return false;
    }
    
    const required = ['employer', 'startDate', 'payRate'];
    for (let field of required) {
      const element = document.getElementById(field);
      if (!element?.value.trim()) {
        alert(t.completeRequired);
        element?.focus();
        return false;
      }
    }
  }
  
  if (page === 3) {
    const payStubCamera = document.getElementById('payStubCamera')?.files.length || 0;
    const payStubFile = document.getElementById('payStubFile')?.files.length || 0;
    const authChecked = document.getElementById('authorization')?.checked;
    
    if (payStubCamera + payStubFile < 1) {
      alert(t.uploadPayStub);
      return false;
    }
    
    if (!authChecked) {
      alert(t.completeRequired);
      return false;
    }
  }
  
  return true;
}

function nextPage() {
  if (!validatePage()) return;
  
  saveFormData();
  page++;
  renderPage();
}

function prevPage() {
  saveFormData();
  page--;
  renderPage();
}

function submitSurvey() {
  if (!validatePage()) return;
  
  // Check if user has already submitted (rate limiting)
  const lastSubmission = localStorage.getItem('taskFormSubmitted');
  if (lastSubmission) {
    const daysSince = Math.floor((Date.now() - parseInt(lastSubmission)) / (1000 * 60 * 60 * 24));
    if (daysSince < 30) {
      alert(translations[lang].alreadySubmitted);
      return;
    }
  }
  
  saveFormData();
  
  // Generate submission data
  formData.submissionId = 'TASK_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
  formData.timestamp = new Date().toISOString();
  formData.status = 'pending';
  
  // Store submission timestamp for rate limiting
  localStorage.setItem('taskFormSubmitted', Date.now().toString());
  
  console.log('Form submitted:', formData);
  
  page = 4;
  renderPage();
}

function resetForm() {
  // Only allow reset for testing
  if (confirm('Are you sure you want to start a new report? This is for testing only.')) {
    localStorage.removeItem('taskFormSubmitted');
    page = 1;
    formData = {};
    renderPage();
  }
}

// Load saved language preference
const savedLang = localStorage.getItem('taskLanguage');
if (savedLang && translations[savedLang]) {
  lang = savedLang;
}

// Initialize the form
renderPage();
</script>
</body>
</html>
